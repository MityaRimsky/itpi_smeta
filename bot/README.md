# Telegram –ë–æ—Ç –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å–º–µ—Ç ITPI

–ë–æ—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≥–µ–æ–¥–µ–∑–∏—á–µ—Å–∫–∏—Ö —Ä–∞–±–æ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –°–ë–¶ –ò–ì–î–ò 2004.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ü§ñ AI-–∞–≥–µ–Ω—Ç –Ω–∞ –±–∞–∑–µ OpenRouter –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- üìä –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ —Ä–∞—Å—Ü–µ–Ω–æ–∫ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- üí∞ –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏ –∏ –Ω–∞–¥–±–∞–≤–∫–∞–º–∏
- üìã –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–π
- üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ Telegram ID

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
cd bot
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```bash
cp .env.example .env
nano .env
```

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**

```env
# Telegram Bot (–ø–æ–ª—É—á–∏—Ç–µ —É @BotFather)
TELEGRAM_BOT_TOKEN=your_bot_token_here
ALLOWED_TELEGRAM_IDS=123456789,987654321

# OpenRouter AI (–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ openrouter.ai)
OPENROUTER_API_KEY=your_openrouter_key_here
OPENROUTER_MODEL=anthropic/claude-3.5-sonnet

# Supabase Database (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)
SUPABASE_URL=https://itpi.webtm.ru
SUPABASE_SERVICE_ROLE_KEY=your_key_here
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

```bash
# –ò–∑ –ø–∞–ø–∫–∏ bot/
python main.py

# –ò–ª–∏ –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
cd /Users/addvibe/projects/itpi_smeta/bot && python main.py
```

## ‚ö†Ô∏è –í–∞–∂–Ω–æ: –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞!

Telegram API –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ **–æ–¥–Ω–æ–º—É —ç–∫–∑–µ–º–ø–ª—è—Ä—É –±–æ—Ç–∞** –ø–æ–ª—É—á–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è. –ï—Å–ª–∏ –∑–∞–ø—É—â–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –æ—à–∏–±–∫–∞:

```
telegram.error.Conflict: terminated by other getUpdates request
```

### –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –±–æ—Ç–∞ –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
ps aux | grep "python main.py"

# –£–±–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –±–æ—Ç–∞
pkill -f "python main.py"

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
python main.py
```

### –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:

```bash
pkill -f "python main.py" 2>/dev/null; sleep 1; python main.py
```

## üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t itpi-smeta-bot .

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker run -d --name smeta-bot --env-file .env itpi-smeta-bot
```

## üìù –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:

```
–¢–æ–ø–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Å—ä–µ–º–∫–∞ 92 –≥–∞, –º–∞—Å—à—Ç–∞–± 1:500, II –∫–∞—Ç–µ–≥–æ—Ä–∏—è
–õ–≠–ü 110 –∫–í, 15 –∫–º, III –∫–∞—Ç–µ–≥–æ—Ä–∏—è
–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–¥–æ—Ä–æ–≥–∏ 25 –∫–º, I –∫–∞—Ç–µ–≥–æ—Ä–∏—è
–ù–∏–≤–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ IV –∫–ª–∞—Å—Å, 20 –ø—É–Ω–∫—Ç–æ–≤
```

### –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞:

- `/start` - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
- `/help` - –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
bot/
‚îú‚îÄ‚îÄ main.py              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ bot.py               # –õ–æ–≥–∏–∫–∞ Telegram –±–æ—Ç–∞
‚îú‚îÄ‚îÄ config.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ Dockerfile          # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ services/           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ database.py     # –†–∞–±–æ—Ç–∞ —Å Supabase
‚îÇ   ‚îú‚îÄ‚îÄ calculator.py   # –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ ai_agent.py     # OpenRouter AI
‚îú‚îÄ‚îÄ api/                # FastAPI endpoints (–±—É–¥—É—â–µ–µ)
‚îú‚îÄ‚îÄ models/             # Pydantic –º–æ–¥–µ–ª–∏
‚îî‚îÄ‚îÄ utils/              # –£—Ç–∏–ª–∏—Ç—ã
```

## üîß –î–µ–ø–ª–æ–π –Ω–∞ Timeweb Cloud

### –ß–µ—Ä–µ–∑ Docker:

1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
2. –°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
docker-compose up -d
```

### –ß–µ—Ä–µ–∑ systemd:

–°–æ–∑–¥–∞–π—Ç–µ `/etc/systemd/system/smeta-bot.service`:

```ini
[Unit]
Description=ITPI Smeta Telegram Bot
After=network.target

[Service]
Type=simple
User=your_user
WorkingDirectory=/path/to/bot
Environment="PATH=/path/to/venv/bin"
ExecStart=/path/to/venv/bin/python main.py
Restart=always

[Install]
WantedBy=multi-user.target
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
sudo systemctl enable smeta-bot
sudo systemctl start smeta-bot
```

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Supabase PostgreSQL —Å:
- 81 —Ä–∞—Å—Ü–µ–Ω–∫–∞ –Ω–∞ —Ä–∞–±–æ—Ç—ã
- 34 –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞
- 42 –¥–æ–±–∞–≤–æ—á–Ω—ã—Ö –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è
- 90 —Å–∏–Ω–æ–Ω–∏–º–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞

## üêõ –û—Ç–ª–∞–¥–∫–∞

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `logs/bot_YYYY-MM-DD.log`

```bash
tail -f logs/bot_$(date +%Y-%m-%d).log
```

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## üë• –ê–≤—Ç–æ—Ä—ã

ITPI Team - 2026
